<h1> Scraping data from a PDF file: Per- and Polyfluoroalkyl Substances (PFAS) concentrations in drinking water on or near military installations, as of August 31, 2017 </h1>

<img src="https://github.com/department-of-veterans-affairs/DAPM-PFAS-PACT-ACT/blob/main/2017%20PDF%20scrape/2017%20histogram.png">
<p>This figure shows the concentrations of PFAS (results) and the number of installations that reported that concentration (frequency). This figure indicates that the 2017 data is right skewed, with more installations reporting lower concentrations, below 1,000 parts per trillion (ppt). This indicates that the measure of central tendency should be the median, rather than the mean. The red vertical lines marks Environmental Protection Agency (EPA)â€™s proposed standard of 4 ppt and historic screening value of 70 ppt. All installations reported at least one concentration above 70 ppt. 
</p>

The code in this repository scrapes data from a publicly available [Department of Defense PDF file](https://www.denix.osd.mil/derp/denix-files/sites/26/2018/03/FY18-HASC-Brief-on-PFOS-PFOA_Mar2018.pdf). The PDF file contains data tables that report concentrations of hazardous waste, specifically PFAS, concentrations, that were collected in drinking water samples on or near military installations. Though the PDF file also reports groundwater samples, this data was not scraped. The report was dated March 2018. The pages with tables for the miltiary bases say "As of August 31, 2017." No other dates were specified for when the samples were collected.

While the goal was to automate cleaning the data tables as much as a possible, the function for cleaning data for each military branch had to be tweaked because of inconsistencies in how the data was reported. Thus, the data for each branch was cleaned separately and then all the data was combined in a single table at the end. 


<b> Highlighted capabilities:</b>

<i> 1. Extracting max value from a messy field.</i> One of the highlights of this code is it extracts the highest reported value from a messy data field that contains multiple nubmers, punctuation, and text. 

<i>2. Collapsing multi-level column headers while still capturing the data.</i> The code also applies tidy data concepts by taking multi-level headers and extracting them as separate data fields, thus capturing the information in newly created columns and collapsing the multi-levels into a singular level of column headers.

<i>3. Scraping data from a PDF file.</i> Finally, it is notoriously hard to scrape data from a PDF file. This code leverages the requests and pdfplumber packages to scrape data in table format from the file. This demonstrates advanced data mining capabilities and accesses data from formats that are consider difficult to mine. 

<b>Input:</b> A single PDF file. 

<b>Output:</b> 

<i> 1. Groundwater summary table. </i> Though this is a summary table for groundwater, it contains a column named "Total Installations with known or suspected release of PFOS/PFOA." Since it's per installation, this may include drinking water samples. 

<i> 2. Drinking water summary table.</i> This contains summmary information for each branch as well as totals across all branches. It includes the total number of installations, the number of drinking water systems at the installations, the number of systems tested, and the number of systems that exceeded the EPA's Lifetime Health Advisory (LHA) level for Perfluorooctanoic acid (PFOA) and Perfluorooctane sulfonic acid (PFOS), which are subgroups of PFAS. At the time, the LHA was 70 ppt for PFOA and PFOS, either separate or combined. 

<i> 3. PFAS concentrations at individual military installations. </i> A separated table for each military branch and whether the data was collected on- or off-base was generated by the code. The tables were then combined into a single table. A column named "results" reports the highest concentration observed at each installation. 

<i>4. Analysis</i> Descriptive statistics and histogram of the PFAS concentrations at installation.
